---
title: "TP1 - *tidyverse* olímpico"
author: "Spiousas - Etchemendy"
date: "`r Sys.Date()`"
output: rmdformats::robobook
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r image_tidyverse, fig.show = "hold", out.width = "10%", fig.align = "default", echo=FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/tidyverse.png")
```
```{r image_rings, fig.show = "hold", out.width = "20%", fig.align = "default", echo=FALSE}
knitr::include_graphics("https://www.seekpng.com/png/full/85-856819_olympic-rings-png-anillos-de-los-juegos-olimpicos.png")
```

En este práctico vamos a usar los paquetes del `tidyverse` para explorar los datos históricos de los Juegos olímpicos.

Antes de empezar les recordamos que tienen que instalar los paquetes del `tidyverse` y adjuntarlo a la sesión de r ejecutando las dos líneas a continuación (si ya instalaron los paquetes del `tidyverse` no hace falta que corran la primera línea):

```{r, eval=FALSE}
install.packages("tidyverse")
library(tidyverse)
```

## Cómo cargar los datos

Los datos históricos de los Juegos Olímpicos son un dataset de **Kaggle**. Para cargarlos a su sesión de R los pueden encontrar en el repositorio de la materia, en las carpetas `Practicos/tidyverse/data`, copiarlos en su carpeta de trabajo y leerlos utilizando la función `read_csv()` del paquete `readr`.

```{r, eval=FALSE}
dictionary_tbl <- read_csv("dictionary.csv")
summer_tbl <- read.csv("summer.csv")
winter_tbl <- read.csv("winter.csv")
```

Otra opción es leer directamente los datos del repositorio de **github** `r icons::icon_style(icons::fontawesome("github"), fill = "black")`. Para esto necesitamos instalar y adjuntar el paquete `Rcurl`.

```{r, eval=FALSE}
install.packages("RCurl")
library(RCurl)
```

Luego, podemos asignar una `url` de la que descargar nuestro archivos `.csv`. EN nuestro caso el código sería como a continuación:

```{r, eval=FALSE}
url <- "https://raw.github.com/spiousas/Inferencia_con_R_UNQ2021/Practicos/tidyverse/data/dictionary.csv"
x <- getURL(url)
dictionary_tbl <- as_tibble(read.csv(text = x))

# ídem para summer_tbl y winter_tbl
```

Las dos formas de leer los archivos pueden tener ligeras diferencias en los nombres de las variables.

## Los datos

`dictionary_tbl`, `winter_tbl` y `summer_tbl` son tres (tristes) `tibbles` que contienen información sobre los países participantes de los juegos olímpicos y resultados de los juegos de invierno y de verano, respectivamente. 

Les dejamos la exploración de las observaciones y las variables a ustedes. Recuerden que tienen funciones como `str()`, `summary()`, `head()` o `View()` que pueden resultar muy útiles para empezar a entender el contenido de cada `tibble`.

## Las consignas

La idea es que pongan en práctica todas las funcionalidades del tidyverse que vimos en las clases, cosas como el `piping` o los verbos de `dplyr`. Es por eso que les recomendamos que, aunque existan métodos alternativos para obtener las respuestas a estas consignas, intenten utilizar las herramientas que les acabamos de mencionar. 

Por supuesto que con lo que vimos en las clases no les va a alcanzar para resolver las consignas, pero para todo lo que no está en las clases existe [**google**](https://www.google.com/).

Vamos a ver qué jugo`r emo::ji("juice")`les podemos sacar a estos datos...

1. Empecemos con algo sencillo. Usando `group_by()` y los verbos de `dplyr`, creen un nuevo tibble (`oro_por_pais`) que tenga, de forma ordenada, la cantidad de medallas de oro que ganó cada país en toda la historia de los Juegos Olímpicos de verano (`summer_tbl`).

```{r echo=FALSE, eval=FALSE}
# Solución
gold_by_country <- summer_tbl %>% 
  filter(Medal=="Gold") %>% 
  group_by(Country) %>% 
  summarise(N = n()) %>% 
  arrange(desc(N))
```

2. ¿Y si ahora queremos ver cuántas de Oro, de Plata y de Bronce? ¿Cómo deberíamos modificar el `pipe` de análisis?
```{r echo=FALSE, eval=FALSE}
# Solución
medal_by_country <- summer_tbl %>% 
  group_by(Country, Medal) %>% 
  summarise(N = n())
```

3. ¿Y para quedarnos con los países en `oro_por_pais` con más de 5 medallas de oro? ¿Está Argentina`r emo::ji("Argentina")` (`ARG`) en ese grupo?
```{r echo=FALSE, eval=FALSE}
# Solución
gold_by_country <- summer_tbl %>% 
  filter(Medal=="Gold") %>% 
  group_by(Country) %>% 
  summarise(N = n()) %>% 
  filter(N>5)
```

4. ¿Quién ganó más medallas de oro en Hockey sobre hielo (`Ice Hockey`) masculino, Canadá (`CAN`) o la Unión Soviética (`URS`)? Consejo: Para filtrar una columna de acuerdo a varios posibles valores discretos les recomiendo investigar el operador `%in%`.

```{r echo=FALSE, eval=FALSE}
winter_tbl %>% 
  filter(Country %in% c("URS", "CAN")) %>% 
  filter(Discipline == "Ice Hockey") %>% 
  filter(Medal == "Gold") %>% 
  filter(Gender == "Male") %>%
  group_by(Country) %>% 
  summarise(N = n())
```